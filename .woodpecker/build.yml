depends_on:
  - "test"

pipeline:
  build-image:
    secrets:
      - "DOCKER_PASSWORD"
      - "DOCKER_USERNAME"
      - "DOCKER_REGISTRY_URL"
    image: plugins/docker
    settings:
      registry: ${DOCKER_REGISTRY_URL}
      username: ${DOCKER_USERNAME}
      password: ${DOCKER_PASSWORD}
      dockerfile: ./Dockerfile
      tags:
        - "latest"
    when:
      event: [push]
      path:
        - "vapronvapw/**"
        - ".woodpecker/*.yml"
        - "**/Dockerfile"
